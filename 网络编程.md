# 关于网络编程的学习

自动开始java编程设计之后，对网络的涉及也逐步深入。现在需要实现一个TCP/IP协议的访问接口，从java的socket编程开始起步。
本文基于网络调试环境为：windows 10 x64

## 1 学习手段：网络抓包
因为网络环境复杂，需要一个非常趁手的工具来帮助我们进行实验测试，目前选择的方式就是使用网络抓包的方式来对具体协议进行分析。
采用的主要工具为Wireshark，这是一个基于Qt的跨平台sniffer软件，并且使用pcap network library来进行封包捕捉。

### 1.1 WireShark基本过滤规则：
监听复杂网络会得到大量冗余信息，以至于很难找到自己需要的部分。过滤器可以帮助我们在庞杂的结果中迅速找到我们需要的信息。
同样，在使用wireshark的时候，最基本的是要熟悉这个工具提供的过滤规则，通过过滤规则的设置可以从复杂的网络嗅探结果中初步过滤我们想要的结果，然后方便后续深入分析。
wireshark提供两种过滤器：
> - 1. 捕捉过滤器：用于决定将什么样的信息记录在捕捉结果中。需要在开始捕捉前设置。
> - 2. 显示过滤器：在捕捉结果中进行详细查找。他们可以在得到捕捉结果后随意修改。

两种过滤器的目的是不同的：
> - 1. 捕捉过滤器是数据经过的第一层过滤器，它用于控制捕捉数据的数量，以避免产生过大的日志文件。
> - 2. 显示过滤器是一种更为强大（复杂）的过滤器。它允许您在日志文件中迅速准确地找到所需要的记录。

并且两种过滤器使用的语法是完全不同的。

#### 1.1.1 捕捉过滤器语法：

#### 1.1.2 显示过滤器语法：


### 1.2 windows下的本地回环抓包方式：
在windows下本地回环不经过网卡，wireshark默认需要安装的wincap不能支持，所以需要使用替换软件进行抓包。
Npcap是一个windows下的libpcap库，用于给wireshark在windows环境下提供支持：
```shell
NPcap is the Windows version of the libpcap library; it includes a driver to support capturing packets. 
```
[https://nmap.org/npcap/](https://github.com/nmap/npcap)给出的说明：
```shell
Npcap is the Nmap Project's packet sniffing library for Windows. It is based on the wonderful Winpcap / Libpcap libraries, but with improved improved speed, portability, security, and efficiency. 
```
安装Npcap首先需要卸载之前已经安装的wincap，然后从[官方下载](https://github.com/nmap/npcap/releases)之后安装。
安装完毕后打开wireshark，就会发现多了一个Npcap Loopback adapter选项，监听这个适配器可以完成对本地回环的测试。

例如调试本地20006端口的TCP/IP访问时，wireshark的过滤器设置为：
```shell
tcp&&ip.addr==127.0.0.1&&tcp.port==20006
```
进行一次TCP/IP访问之后，可以看到wireshark已经捕获到了具体的访问信息，这个时候可以停止捕获，然后将捕获结果导出，用于后续深入分析。

参考文档：
> - 1. [wireshark监听本地localhost/127.0.0.1回环网络](http://blog.techbeta.me/2015/12/wireshark-Loopback/)


## 2 网络协议分析：
通过第一章的内容，我们可以获取基本的网络访问结果。接下来就需要对这个网络嗅探结果进入深入分析，查看对应协议的数据包来进行分析协议，在这个过程中就可以找到我们需要的内容了。

### 2.1 TCP/IP协议：

